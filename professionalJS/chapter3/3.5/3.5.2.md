# 位操作符

> ECMAScript中所有数值都是IEEE-75464位格式存储，但操作符并不直接操作64位。而是先将64位的值转换成32位的整数，然后再执行操作，最后再将结果转换回64位。

1. 有符号的整数，32位中的前31位用于表示整数的值，第32位用于表示数值的符号：0表示正数，1表示负数
2. 这个符号的位叫做符号位，符号位决定了其他位数值的格式。
```
//正数以纯二进制格式存储，31位中的每一位都表示2的幂
//数值18的二进制表示
00000000000000000000000000010010 
//更简洁的
10010
2^4*1 + 2^3*0 + 2^2*0 + 2^1*1 + 2^0*0
16 + 0 + 0 + 2 + 0
```

```
负数同样以二进制码存储，但使用的格式是二进制补码，需要经过以下3个步骤
1. 求这个数值绝对值的二进制码
18: 0000 0000 0000 0000 0000 0000 0001 0010
2. 求二进制反码，
1111 1111 1111 1111 1111 1111 1110 1101
3. 得到的二进制反码加1
1111 1111 1111 1111 1111 1111 1110 1110
ECMAScript会尽力像我们隐藏所有这些信息。在以二进制字符串输出一个负数时，我们看到的只是这个负数绝对值的二进制码前面加一个负号

var num = -18
alert(num.toString(2)) // -10010
```

## 按位非(NOT)

1. 按位非操作符由一个波浪线(~)表示，
2. 执行结果就是返回数值的反码
3. 按位非操作的本质：操作数的负值减1
```
var num1 = 25
var num2 = ~num1
alert(num2) //-26
//同
var num2 = -num1 - 1
//由于按位非是在数值表示的最底层执行操作，因此速度更快
```

## 按位与(AND)

1. 按位与操作符由一个和号符(&)表示
2. 按位与操作就是将两个数值的每一位对齐，然后根据下表中的规则，对相同位置上的两个数执行AND操作

第一个数值的位|第二个数值的位|结果
---|---|---
1|1|1
1|0|0
0|1|0
0|0|0

```
25 = 0000 0000 0000 0000 0000 0000 0001 1001
 3 = 0000 0000 0000 0000 0000 0000 0000 0011
AND= 0000 0000 0000 0000 0000 0000 0000 0001
```

## 按位或(OR)

1. 按位或操作符由一个竖线符(|)表示,遵循下面真值表

第一个数值的位|第二个数值的位|结果
---|---|---
1|1|1
1|0|1
0|1|1
0|0|0

## 按位异或(XOR)

1. 按位异或操作符由一个符号(^) 表示

第一个数值的位|第二个数值的位|结果
---|---|---
1|1|0
1|0|1
0|1|1
0|0|0

这个操作在两个数值对应位上只有一个1时才返回1，如果对应的两位都是1或都是0，则返回0

## 左移

1. 左移操作符由两个小于号(<<)表示，这个操作符会将数值的所有位向左移动指定的位数
2. 左移操作会以0来填充这些空位
3. 左移不会影响操作数的符号位

```
var oldValue = 2 // 10
var newValue = oldValue << 5 //1000000 十进制的64
```

## 有符号的右移

1. 有符号的右移操作符由两个大于号(>>)表示，这个操作符会将数值向右移动，但保留符号位
2. 原数值左侧，符号位右侧，会出现空格，用符号位的值来填充所有空格
```
var oldValue = 64
var newValue = oldValue >> 5
```

## 无符号右移

1. 无符号右移操作符由3个(>>>)表示
2. 对于正数来说无符号右移的结果与有符号右移的相同
3. 无符号右移操作符会把负数的二进制码当成正数的二进制码。而且，由于负数以其绝对值的二进制补码形式表示，因此就会导致无符号右移后的结果非常之大
```
var oldValue = -64
var newValue = oldValue >>> 5
```

之所以这么大因为-64的二进制编码为11111111111111111111111111000000，而且无符号右移操作会把这个二进制码当成正数的二进制码，换算成十进制就是4294967232.如果把这个值右移5位就会变成00001111111111111111111111111110，即十进制134217726